# Telegram Coder Agent Swarm Package
apiVersion: agents.example.io/v1alpha1
kind: Package
metadata:
  name: "@goondan/sample-telegram-coder"
  version: "0.0.1"
  annotations:
    description: "Telegram Bot Coding Agent Swarm Sample"
spec:
  dependencies:
    - "@goondan/base"

---

# Telegram Coder Agent Swarm
# Telegram 봇을 통한 원격 코딩 에이전트 스웜 샘플
apiVersion: agents.example.io/v1alpha1
kind: Model
metadata:
  name: default-model
spec:
  provider: anthropic
  name: claude-sonnet-4-5

---

apiVersion: agents.example.io/v1alpha1
kind: Agent
metadata:
  name: planner
  labels:
    role: orchestrator
spec:
  modelConfig:
    modelRef: { kind: Model, name: default-model }
    params:
      temperature: 0.3
      maxTokens: 4096
  prompts:
    systemRef: "./prompts/planner.system.md"
  tools:
    - { kind: Tool, name: agents, package: "@goondan/base" }

---

apiVersion: agents.example.io/v1alpha1
kind: Agent
metadata:
  name: coder
  labels:
    role: executor
spec:
  modelConfig:
    modelRef: { kind: Model, name: default-model }
    params:
      temperature: 0.5
      maxTokens: 8192
  prompts:
    systemRef: "./prompts/coder.system.md"
  tools:
    - { kind: Tool, name: file-system, package: "@goondan/base" }
    - { kind: Tool, name: bash, package: "@goondan/base" }

---

apiVersion: agents.example.io/v1alpha1
kind: Agent
metadata:
  name: reviewer
  labels:
    role: reviewer
spec:
  modelConfig:
    modelRef: { kind: Model, name: default-model }
    params:
      temperature: 0.2
      maxTokens: 4096
  prompts:
    systemRef: "./prompts/reviewer.system.md"
  tools:
    - { kind: Tool, name: file-system, package: "@goondan/base" }

---

apiVersion: agents.example.io/v1alpha1
kind: Swarm
metadata:
  name: coding-swarm
spec:
  entrypoint: { kind: Agent, name: planner }
  agents:
    - { kind: Agent, name: planner }
    - { kind: Agent, name: coder }
    - { kind: Agent, name: reviewer }
  policy:
    maxStepsPerTurn: 32

---

# Connection: telegram → coding-swarm
apiVersion: agents.example.io/v1alpha1
kind: Connection
metadata:
  name: telegram-to-coding-swarm
spec:
  connectorRef: { kind: Connector, name: telegram, package: "@goondan/base" }
  auth:
    staticToken:
      valueFrom:
        env: "TELEGRAM_BOT_TOKEN"
  ingress:
    rules:
      - match:
          event: telegram.message
        route:
          agentRef: { kind: Agent, name: planner }
      - route: {}
